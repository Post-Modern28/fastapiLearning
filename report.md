---

# –û—Ç—á—ë—Ç –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º –±–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥–∞ –º–æ–¥–µ–ª–µ–π

(BCI, Adaptive Supervised PatchNCE, PPT)

---
–°–Ω–æ—Å–∫–∞ –∑–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é: (—Ä–µ–ø–æ—Ä—Ç –Ω–µ –≥–æ—Ç–æ–≤)

* –ü—Ä–æ–≤–µ–¥–µ–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ BCI (PyramidPix2Pix) —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è **1024x1024** (–≤–º–µ—Å—Ç–æ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å —Å–∂–∞—Ç–∏–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ **324x324** –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –æ–±—Ä–µ–∑–∫–æ–π –¥–æ **256x256**). –ü–æ—Å–ª–µ —á–µ–≥–æ –±—ã–ª –ø—Ä–æ–≤–µ–¥—ë–Ω –ø–µ—Ä–µ—Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫. –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ —É–≤–µ–ª–∏—á–∏–ª–∏—Å—å (–µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤). –û–¥–Ω–∞–∫–æ, –∑–Ω–∞—á–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –ø–æ —Ç–æ–π –∂–µ —Å—Ö–µ–º–µ (—Å–∂–∏–º–∞–µ—Ç –¥–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ **256x256**). –ë—ã–ª –ø—Ä–æ–≤–µ–¥—ë–Ω –ø–µ—Ä–µ—Ç–µ—Å—Ç —Å –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º —Å–∂–∞—Ç–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∏—Ç—å—Å—è –º–µ—Ç—Ä–∏–∫–∏ SSIM, —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤ —Å—Ç–∞—Ç—å–µ (**0.47**). PSNR –ø—Ä–∏ —ç—Ç–æ–º –æ—Å—Ç–∞–ª—Å—è –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ (18.0).

* –ë—ã–ª–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–æ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Å—Ç–∞—Ç—å–∏ PSPStain https://arxiv.org/pdf/2407.03655 . –û–±—É—á–µ–Ω–∏–µ –ø—Ä–æ–≤–æ–¥–∏–ª–æ—Å—å –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ **MIST**. –ú–µ—Ç—Ä–∏–∫–∏ PSNR –∏ SSIM, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ —Å—Ç–∞—Ç—å–µ, –±—ã–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã (SSIM **0.198** –ø—Ä–∏ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö **0.187**, PSNR **14.31** –ø—Ä–∏ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö **14.19**)

* –ù–∏–∂–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ—Ä—Ç –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –Ω–µ–¥–µ–ª–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–æ –Ω–µ–±–æ–ª—å—à–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π —Å –≤—ã—Ä–µ–∑–∫–∞–º–∏ –∏–∑ —Å—Ç–∞—Ç—å–∏ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ (–≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏, —Ç.–∫. —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã Conda –Ω–∞ –æ–±—â—É—é —Å—Ä–µ–¥—É Zhores)
---


## 1. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤

### üîπ BCI

#### –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é: https://arxiv.org/pdf/2204.11425

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏

–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –º–æ–¥–µ–ª—å **PyramidPix2Pix**, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—à–∏—Ä—è–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É Pix2Pix –∑–∞ —Å—á—ë—Ç –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –ø–∏—Ä–∞–º–∏–¥–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.  
–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å—Ç—Ä–æ–∏—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—ç—Ç–∞–ø–Ω–æ: —Å–Ω–∞—á–∞–ª–∞ –Ω–∞ –Ω–∏–∑–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≥—Ä—É–±–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ü–µ–Ω—ã, –∑–∞—Ç–µ–º –Ω–∞ –∫–∞–∂–¥–æ–º –ø–æ—Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–≤–Ω–µ –ø–∏—Ä–∞–º–∏–¥—ã –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–µ—Ç–∞–ª–∏ –∏ —É—Ç–æ—á–Ω—è—é—Ç—Å—è —Ç–µ–∫—Å—Ç—É—Ä—ã.  

<img width="730" height="334" alt="image" src="https://github.com/user-attachments/assets/56166070-f85c-4a5f-b131-ad5b59f2661f" />


---

**–î–∞—Ç–∞—Å–µ—Ç:** BCI

* PSNR: **18.064**
* SSIM: **0.3674**

*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏–∑ —Å—Ç–∞—Ç—å–∏:*

> –í –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ BCI —Å–æ–æ–±—â–∞–ª–æ—Å—å –æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö SSIM (0.477) –∏ PSNR (21.160) –Ω–∞ —ç—Ç–æ–º –∂–µ –¥–∞—Ç–∞—Å–µ—Ç–µ. –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∏–∂–µ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö.
> –ë—ã–ª –∑–∞–º–µ—Ç–µ–Ω —Ç—Ä–µ–Ω–¥ –Ω–∞ –ø–µ—Ä–µ–æ–±—á—É–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–ø–∞–¥–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –Ω–∞ —ç–ø–æ—Ö–∞—Ö > 60)

---

#### –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
cd /gpfs/gpfs0/gubanov-lab/benchmarking/BCI/PyramidPix2pix
sbatch train_BCI.sh
# –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
cat logs/train_test_eval_bci_{job_num}.out

```

---

*–ü—Ä–∏–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π*

| H&E | HER2_Gen | HER2_Real |
|-----|----------|-----------|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/bd1d6a1c-7b1d-409c-a71a-903c9672ac84" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/e927e1c8-440d-48e9-b071-525d8905f45d" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/32c40ac2-bde1-43c0-99cf-551fde16fd54" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/7fe99d6b-4fc3-42b7-a1cb-325a49c0d728" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/0e3403bc-23e1-47db-8217-833b429701be" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/9c67e3b9-76ef-4609-b879-ed09f77f2323" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/c37caffe-e073-447e-afb6-007ba0cfd329" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/2359bfec-678d-4d0c-9582-c9a22a9f2469" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/e0a1e595-6d55-4925-afc8-9af85fe592f7" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/cb201023-c213-4072-836f-9306b176b78e" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/60e57faa-7fa3-40ef-8bdf-fe8ca7021725" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/08fd1aa7-3dc1-4a33-abf7-b722d04e51ae" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/b772fe7a-81e4-4e62-825a-8109fb896952" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/921f89ec-e262-437e-8e28-78c55f250196" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/cf7f8095-2a64-4e83-a335-fc2ce876b346" />|

---

### üîπ PPT (MICCAI 2024)

#### –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é: https://papers.miccai.org/miccai-2024/paper/0817_paper.pdf


#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏

PPT (Pathology Pretrained Transformer) –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ **Vision Transformer (ViT)** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–∞—Ç–æ–≥–∏—Å—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–¥—Ö–æ–¥–∞:

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **patch-based –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ** (—Ä–∞–∑–±–∏–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –ø–∞—Ç—á–∏).
* **Supervised pretraining** –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ –∏–º–º—É–Ω–æ–≥–∏—Å—Ç–æ—Ö–∏–º–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∞—Å–∏—Ç–µ–ª–µ–π.
* **Transformer encoder** —Å self-attention, —á—Ç–æ–±—ã –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏.

<img width="496" height="300" alt="image" src="https://github.com/user-attachments/assets/3823481a-b976-47f4-b8a1-f218ad8e000c" />


**–î–∞—Ç–∞—Å–µ—Ç:** PAX5

* SSIM: **0.2469**
* PSNR: **12.8244**
* LPIPS: **0.5808**
* FID: **85.7034**

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
–ú–æ–¥–µ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è **1000√ó1000** (–¥–µ—Ñ–æ–ª—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–±—É—á–µ–Ω–∏—è).
–≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–º–µ—é—Ç —Ä–∞–∑–º–µ—Ä **2000√ó2000**.
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –ø–æ—Å–ª–µ —Ä–∞—Å—Ç—è–∂–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–æ 2000√ó2000.
–í —Å—Ç–∞—Ç—å–µ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∫–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∞–≤—Ç–æ—Ä—ã –ø—Ä–æ–≤–æ–¥–∏–ª–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ.
–í–æ–∑–º–æ–∂–Ω–æ, —Å–∂–∞—Ç–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–≥–ª–æ –±—ã –¥–∞—Ç—å –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏.



---

#### –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ö–æ–¥ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è PPT
cd /gpfs/gpfs0/gubanov-lab/benchmarking/PPT
sbatch train_ppt.sh
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
sbatch test_all_epochs.sh
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
sbatch evaluate_all.sh
cat logs/evaluate_all.out
 
```
---

*–ü—Ä–∏–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π*

| H&E | HER2_Gen | HER2_Real |
|-----|----------|-----------|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/6fe21182-07d8-4d25-8aec-029ccec17395" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/f1710028-b44d-41d1-8497-ce184d117094" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/2903c3c1-62cf-432b-99a6-15e21c03fc99" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/8cd2a92c-e5b4-436c-afbc-7fc5b6764d95" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/edeb5f74-8cda-4a40-a503-bbb7c1e5eb17" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/04d4c654-91a5-46e6-97fa-c30430681aa0" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/d9c52eac-f453-4afd-a6d4-060fa690ab5f" /> |<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/f944871f-8be5-46f0-aa3c-b01ac895b52c" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/edd831e2-f96c-4ac5-8a95-f8e8d00fb828" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/2b875abe-176f-498b-b4c3-509fb9864793" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/d21b2a26-2cee-43ee-a8a5-4f9c87c9f473" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/7c78dd4d-d373-4580-ba8c-c1bd682a72d1" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/f2149932-0390-4b9e-a049-dad3d0ec6cc9" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/7ed972c9-c363-4adf-8722-96c6228d15d2" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/ad98c308-e9c4-4088-bc86-23a8ee449c72" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/e2d4dda0-c38e-4197-951a-0234e77f4c58" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/aa106fb8-b5c0-4139-b9b7-cf6b93c4fae5" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/63e76f4c-387f-4d66-8de3-b4620dc53009" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/ee0fc054-dad4-4678-9045-5beda2e78846" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/50a00b57-07fa-4331-8532-c0808d8fe5c9" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/52beebbc-c9cf-4808-824b-793e4e7cb07b" />|

---

### üîπ Adaptive Supervised PatchNCE (NCE) (MICCAI 2023)

#### –°—Å—ã–ª–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—å—é: https://arxiv.org/pdf/2303.06193

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –º–æ–¥–µ–ª–∏

Adaptive Supervised PatchNCE —Ä–∞—Å—à–∏—Ä—è–µ—Ç –ø–æ–¥—Ö–æ–¥ **Contrastive Learning** –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –º–µ–¥–∏—Ü–∏–Ω–µ.
–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:

* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **PatchNCE loss**, –≥–¥–µ –ø–∞—Ç—á–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∏ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–∫—Ä—ã—Ç–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.
* **–ö–æ–Ω—Ç—Ä–∞—Å—Ç–∏–≤–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ**
* –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ **U-Net**, –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ç–æ—Ä ‚Äî PatchGAN.

<img width="518" height="337" alt="image" src="https://github.com/user-attachments/assets/68e78c33-3c4f-432b-840d-d38f7568be6a" />


**–î–∞—Ç–∞—Å–µ—Ç:** MIST (–ø–∞–ø–∫–∞ HER2)

* Perceptual Hash (ResNet50):
  [0.4837, 0.4422, 0.2710, 0.8186], avg: **0.503875**
* FID: **49.35**
* PSNR: **14.54**
* SSIM: **0.2161**
* KID: **11.1**

*–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏–∑ —Å—Ç–∞—Ç—å–∏:*

> –ê–≤—Ç–æ—Ä—ã NCE (LASP) –∑–∞—è–≤–ª—è—é—Ç:
>
> * SSIM: **0.2004**
> * PHVT = 001: layer1 = 0.4534, layer2 = 0.4150, layer3 = 0.2665, layer4 = 0.8174, avg = **0.4881**
> * FID: **51.4**
> * KID: **12.4**
>   –ù–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏ –Ω–∞ –∑–∞—è–≤–ª–µ–Ω–Ω—ã–µ.


---

#### –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ö–æ–¥ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è NCE
cd /gpfs/gpfs0/gubanov-lab/benchmarking/NCE
sbatch train_nce.sh
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
sbatch test_nce.sh
# –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
sbatch eval_nce.sh
cat logs/eval_nce_cascade_{job_num}.out
 
```

---

*–ü—Ä–∏–º–µ—Ä —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π*

| H&E | HER2_Gen | HER2_Real |
|-----|----------|-----------|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/397bb978-efd2-4a63-ba03-31a10cc93549" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/d9f9e0b6-acfe-423d-b6eb-c2bb53ccaea5" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/8284216f-7ce9-4d07-b199-bc8fa33ac11f" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/22726c95-0ca2-4a2c-9077-c9dd0ac2e615" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/6e7c6fc4-30d0-486e-be46-1f24c9d60210" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/f73b8085-6ccf-4282-a888-c088f5207967" />|
|<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/a5505155-ea9c-4d51-8786-699a7aee13e3" /> |<img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/2d4abe8e-e948-49a2-946c-1a95f78028d1" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/00031912-f32a-4bb1-9b6b-3dbc1025d2b1" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/969655f4-596d-4d4d-a3a4-790a65647e58" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/e0c3e9eb-3f76-4c62-a7e9-47edc3c58091" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/414e7830-d305-4195-aa25-3b574bd1f9d2" />|
| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/2019e365-4f81-41e4-bb87-fdbe60fd82db" />| <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/6dac11e6-e2b3-4172-b179-96437952ad98" /> | <img width="1024" height="1024" alt="image" src="https://github.com/user-attachments/assets/10ee01bc-ae90-47d2-98d0-1f3d7b78ec62" />|


---

## 2. –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–æ–¥–µ–ª–µ–π

| –ú–æ–¥–µ–ª—å                 | –î–∞—Ç–∞—Å–µ—Ç   | PSNR ‚Üë  | SSIM ‚Üë  | LPIPS ‚Üì | FID ‚Üì   | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ                     |
| ---------------------- | --------- | ------- | ------- | ------- | ------- | ------------------------------ |
| **BCI (–Ω–∞—à)**          | BCI       | 18.064  | 0.3674  | ‚Äì       | ‚Äì       | –ü–æ—Å–ª–µ–¥–Ω—è—è —ç–ø–æ—Ö–∞, –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–∞—è |
| **BCI (—Å—Ç–∞—Ç—å—è)**       | BCI       | 21.160  | 0.477   | ‚Äì       | ‚Äì       | –ó–∞—è–≤–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è            |
| **PPT (–Ω–∞—à)**          | PAX5      | 12.8244 | 0.2469  | 0.5808  | 85.7034 | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å —Ä–µ—Å–∫–µ–π–ª–æ–º          |
| **PPT (—Å—Ç–∞—Ç—å—è)**       | PAX5      | 17.4063 | 0.35480 | 0.2988  | 80      | –ó–∞—è–≤–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è            |
| **NCE (–Ω–∞—à)**          | MIST/HER2 | 14.54   | 0.2161  | ‚Äì       | 49.35   | KID = 11.1, avg PHVT = 0.503875 |
| **NCE (—Å—Ç–∞—Ç—å—è, LASP)** | MIST      | ‚Äì       | 0.2004  | ‚Äì       | 51.4    | KID = 12.4, avg PHVT = 0.4881  |

---

## 3. –í—ã–≤–æ–¥

–í—Å–µ –º–æ–¥–µ–ª–∏ –ø–æ–∫–∞–∑–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∏–∂–µ –∑–∞—è–≤–ª–µ–Ω–Ω—ã—Ö, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º NCE, –≥–¥–µ –º–µ—Ç—Ä–∏–∫–∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –±–ª–∏–∑–∫–∏ –∫ –º–µ—Ç—Ä–∏–∫–∞–º –∏–∑ —Å—Ç–∞—Ç—å–∏. –ü—Ä–∏ —ç—Ç–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è NCE —Å—Ç—Ä–µ–º—è—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

---
